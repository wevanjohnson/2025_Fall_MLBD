library(tidyverse)
library(caret)
library(dslabs)
data(heights)
View(heights)
y <- heights$sex
x <- heights$height
set.seed(2007)
createDataPartition(y, times = 1,
p = 0.5, list = FALSE)
sample(1:1050, size=525, replace=F)
sort(sample(1:1050, size=525, replace=F))
set.seed(2007)
test_index <- createDataPartition(y, times = 1,
p = 0.5, list = FALSE)
test_set <- heights[test_index, ]
train_set <- heights[-test_index, ]
y_hat <- sample(c("Male", "Female"),
length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
mean(y_hat == test_set$sex)
y_hat <- sample(c("Male", "Female"),
length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
mean(y_hat == test_set$sex)
y_hat <- sample(c("Male", "Female"),
length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
mean(y_hat == test_set$sex)
y_hat <- sample(c("Male", "Female"),
length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
mean(y_hat == test_set$sex)
y_hat <- sample(c("Male", "Female"),
length(test_index), replace = TRUE) %>%
factor(levels = levels(test_set$sex))
mean(y_hat == test_set$sex)
heights %>% group_by(sex) %>%
summarize(mean(height), sd(height))
y_hat <- ifelse(x > 62, "Male", "Female") %>%
factor(levels = levels(test_set$sex))
mean(y == y_hat)
cutoff <- seq(61, 70)
accuracy <- map_dbl(cutoff, function(x){
y_hat <- ifelse(train_set$height > x, "Male", "Female") %>%
factor(levels = levels(test_set$sex))
mean(y_hat == train_set$sex)
})
data.frame(cutoff, accuracy) %>%
ggplot(aes(cutoff, accuracy)) +
geom_point() +
geom_line()
max(accuracy)
best_cutoff <- cutoff[which.max(accuracy)]
best_cutoff
y_hat <- ifelse(test_set$height >
best_cutoff,"Male","Female") %>%
factor(levels = levels(test_set$sex))
y_hat <- factor(y_hat)
mean(y_hat == test_set$sex)
table(predicted = y_hat, actual = test_set$sex)
test_set %>%
mutate(y_hat = y_hat) %>%
group_by(sex) %>%
summarize(accuracy = mean(y_hat == sex))
prev <- mean(y == "Male")
prev
y_hat
cm <- confusionMatrix(data = y_hat,
reference = test_set$sex)
cm
library(dslabs); data("mnist_27")
mnist_27$test %>% ggplot(aes(x_1, x_2, color = y)) + geom_point()
knn3
?knn3
mnist_27$train
x <- 1:10
y <- rnorm(10,x,2)
plot(x,y)
lm(y~x)
summary(lm(y~x))
View(mnist_27$train)
knn_fit <- knn3(mnist_27$train$y ~ mnist_27$train$x_1, k = 5)
knn_fit <- knn3(y ~ x1, data = mnist_27$train, k = 5)
View(mnist_27$train)
knn_fit <- knn3(y ~ x_1, data = mnist_27$train, k = 5)
knn_fit
knn_fit <- knn3(y ~ x_1+x_2, data = mnist_27$train, k = 5)
knn_fit
knn_fit <- knn3(y ~ ., data = mnist_27$train, k = 5)
y_hat_knn <- predict(knn_fit, mnist_27$test, type = "class")
y_hat_knn
confusionMatrix(y_hat_knn, mnist_27$test$y)
